#! /usr/bin/env ruby

lib_path = File.expand_path(File.dirname(__FILE__)) + "/../lib/"
$LOAD_PATH << lib_path unless $LOAD_PATH.include? lib_path

require 'sudocoup'

host    = ARGV.shift
port    = ARGV.shift
ws_port = ARGV.shift

if ENV["LOG"]
  log = "log/sudocoup.log"
  file = File.open(log, "a")
  Sudocoup::Logger.logger = Logger.new(log)
end

if ENV['WEB']
  fork do
    Sudocoup::WebServer.run!
  end
end

Sudocoup::Server.start(
  :host => host,
  :port => port,
  :ws_port => ws_port,
  :file => "data/1.sud",
  :size => 2
)
